global
    daemon
    log stdout local0

defaults
    mode tcp
    timeout connect 5s
    timeout client 30s
    timeout server 30s
    log global

# Stats
frontend stats
    bind *:8080
    mode http
    stats enable
    stats uri /stats

# MySQL Frontend
frontend mysql-frontend
    bind *:3309
    mode tcp
    default_backend mysql-backend

# MySQL Backend - Configuration simplifiée
backend mysql-backend
    mode tcp
    balance roundrobin
    
    # Health check TCP simple (sans authentification MySQL)
    option tcp-check
    tcp-check connect port 3306
    
    # Serveurs avec paramètres moins stricts
    server node1 billetterie-mariadb-node1:3306 check inter 5s rise 1 fall 3
    server node2 billetterie-mariadb-node2:3306 check inter 5s rise 1 fall 3
    server node3 billetterie-mariadb-node3:3306 check inter 5s rise 1 fall 3
